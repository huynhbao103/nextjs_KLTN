"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/weather/route";
exports.ids = ["app/api/weather/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fweather%2Froute&page=%2Fapi%2Fweather%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fweather%2Froute.ts&appDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fweather%2Froute&page=%2Fapi%2Fweather%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fweather%2Froute.ts&appDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var D_Kh_a_lu_n_t_t_nghi_p_fe_kltn_src_app_api_weather_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/weather/route.ts */ \"(rsc)/./src/app/api/weather/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/weather/route\",\n        pathname: \"/api/weather\",\n        filename: \"route\",\n        bundlePath: \"app/api/weather/route\"\n    },\n    resolvedPagePath: \"D:\\\\Khóa luận tốt nghiệp\\\\fe-kltn\\\\src\\\\app\\\\api\\\\weather\\\\route.ts\",\n    nextConfigOutput,\n    userland: D_Kh_a_lu_n_t_t_nghi_p_fe_kltn_src_app_api_weather_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/weather/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3ZWF0aGVyJTJGcm91dGUmcGFnZT0lMkZhcGklMkZ3ZWF0aGVyJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd2VhdGhlciUyRnJvdXRlLnRzJmFwcERpcj1EJTNBJTVDS2glQzMlQjNhJTIwbHUlRTElQkElQURuJTIwdCVFMSVCQiU5MXQlMjBuZ2hpJUUxJUJCJTg3cCU1Q2ZlLWtsdG4lNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUQlM0ElNUNLaCVDMyVCM2ElMjBsdSVFMSVCQSVBRG4lMjB0JUUxJUJCJTkxdCUyMG5naGklRTElQkIlODdwJTVDZmUta2x0biZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNtQjtBQUNoRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWZvb2QtcmVjb21tZW5kYXRpb24vPzE1OGUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRDpcXFxcS2jDs2EgbHXhuq1uIHThu5F0IG5naGnhu4dwXFxcXGZlLWtsdG5cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcd2VhdGhlclxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2VhdGhlci9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3dlYXRoZXJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL3dlYXRoZXIvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJEOlxcXFxLaMOzYSBsdeG6rW4gdOG7kXQgbmdoaeG7h3BcXFxcZmUta2x0blxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFx3ZWF0aGVyXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL3dlYXRoZXIvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0LCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fweather%2Froute&page=%2Fapi%2Fweather%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fweather%2Froute.ts&appDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/weather/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/weather/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n\n// Cache in memory (trong production nên dùng Redis)\nconst weatherCache = new Map();\nconst CACHE_DURATION = 10 * 60 * 1000; // 10 minutes\n// Rate limiting (trong production nên dùng Redis)\nconst rateLimitMap = new Map();\nconst RATE_LIMIT_WINDOW = 60 * 1000; // 1 minute\nconst RATE_LIMIT_MAX_REQUESTS = 30; // 30 requests per minute\n// Helper function để lấy client IP\nfunction getClientIP(request) {\n    return request.headers.get(\"x-forwarded-for\")?.split(\",\")[0] || request.headers.get(\"x-real-ip\") || \"unknown\";\n}\n// Rate limiting check\nfunction checkRateLimit(clientIP) {\n    const now = Date.now();\n    const clientData = rateLimitMap.get(clientIP);\n    if (!clientData || now > clientData.resetTime) {\n        rateLimitMap.set(clientIP, {\n            count: 1,\n            resetTime: now + RATE_LIMIT_WINDOW\n        });\n        return true;\n    }\n    if (clientData.count >= RATE_LIMIT_MAX_REQUESTS) {\n        return false;\n    }\n    clientData.count++;\n    return true;\n}\n// Cache helper\nfunction getCachedData(key) {\n    const cached = weatherCache.get(key);\n    if (!cached) return null;\n    if (Date.now() - cached.timestamp > CACHE_DURATION) {\n        weatherCache.delete(key);\n        return null;\n    }\n    return cached.data;\n}\nfunction setCachedData(key, data) {\n    weatherCache.set(key, {\n        data,\n        timestamp: Date.now()\n    });\n}\n// Convert OpenWeatherMap data to our format\nfunction convertOpenWeatherMapData(weatherData, forecastData) {\n    const current = weatherData;\n    // Safe access to nested properties\n    const locationName = current?.name || \"Unknown Location\";\n    const country = current?.sys?.country || \"\";\n    const latitude = current?.coord?.lat || 0;\n    const longitude = current?.coord?.lon || 0;\n    const timezone = current?.timezone || 0;\n    const tempC = current?.main?.temp || 0;\n    const tempF = tempC * 9 / 5 + 32;\n    const feelsLikeC = current?.main?.feels_like || tempC;\n    const feelsLikeF = feelsLikeC * 9 / 5 + 32;\n    const humidity = current?.main?.humidity || 0;\n    const pressure = current?.main?.pressure || 0;\n    const windSpeed = current?.wind?.speed || 0;\n    const windDeg = current?.wind?.deg || 0;\n    const windKph = windSpeed * 3.6;\n    const windMph = windSpeed * 2.237;\n    const visibility = current?.visibility || 0;\n    const visibilityKm = visibility / 1000;\n    const weatherCondition = current?.weather?.[0] || {};\n    const conditionText = weatherCondition.description || \"Unknown\";\n    const conditionIcon = weatherCondition.icon ? `/api/weather-icon?icon=${weatherCondition.icon}` : \"\";\n    const conditionCode = weatherCondition.id || 0;\n    return {\n        location: {\n            name: locationName,\n            country: country,\n            region: \"\",\n            lat: latitude,\n            lon: longitude,\n            timezone: timezone,\n            localtime: new Date().toISOString()\n        },\n        current: {\n            temp_c: tempC,\n            temp_f: tempF,\n            condition: {\n                text: conditionText,\n                icon: conditionIcon,\n                code: conditionCode\n            },\n            humidity: humidity,\n            wind_kph: windKph,\n            wind_mph: windMph,\n            wind_dir: getWindDirection(windDeg),\n            pressure_mb: pressure,\n            feelslike_c: feelsLikeC,\n            feelslike_f: feelsLikeF,\n            uv: 0,\n            visibility_km: visibilityKm,\n            last_updated: new Date().toISOString(),\n            vis_km: visibilityKm\n        },\n        forecast: {\n            forecastday: forecastData ? convertForecastData(forecastData) : []\n        }\n    };\n}\nfunction convertForecastData(forecastData) {\n    if (!forecastData?.list || !Array.isArray(forecastData.list)) {\n        console.warn(\"Invalid forecast data structure:\", forecastData);\n        return [];\n    }\n    // Group by day\n    const dailyData = new Map();\n    forecastData.list.forEach((item)=>{\n        if (!item?.dt || !item?.main || !item?.weather?.[0]) {\n            console.warn(\"Invalid forecast item:\", item);\n            return;\n        }\n        const date = new Date(item.dt * 1000).toDateString();\n        if (!dailyData.has(date)) {\n            dailyData.set(date, {\n                date: new Date(item.dt * 1000).toISOString().split(\"T\")[0],\n                day: {\n                    maxtemp_c: item.main.temp_max || 0,\n                    maxtemp_f: (item.main.temp_max || 0) * 9 / 5 + 32,\n                    mintemp_c: item.main.temp_min || 0,\n                    mintemp_f: (item.main.temp_min || 0) * 9 / 5 + 32,\n                    avgtemp_c: item.main.temp || 0,\n                    avgtemp_f: (item.main.temp || 0) * 9 / 5 + 32,\n                    maxwind_kph: (item.wind?.speed || 0) * 3.6,\n                    maxwind_mph: (item.wind?.speed || 0) * 2.237,\n                    totalprecip_mm: item.rain?.[\"3h\"] || 0,\n                    totalprecip_in: (item.rain?.[\"3h\"] || 0) / 25.4,\n                    avghumidity: item.main.humidity || 0,\n                    condition: {\n                        text: item.weather[0].description || \"Unknown\",\n                        icon: item.weather[0].icon ? `/api/weather-icon?icon=${item.weather[0].icon}` : \"\",\n                        code: item.weather[0].id || 0\n                    },\n                    uv: 0\n                },\n                hour: []\n            });\n        }\n        dailyData.get(date).hour.push({\n            time: new Date(item.dt * 1000).toISOString(),\n            temp_c: item.main.temp || 0,\n            temp_f: (item.main.temp || 0) * 9 / 5 + 32,\n            condition: {\n                text: item.weather[0].description || \"Unknown\",\n                icon: item.weather[0].icon ? `/api/weather-icon?icon=${item.weather[0].icon}` : \"\",\n                code: item.weather[0].id || 0\n            },\n            wind_kph: (item.wind?.speed || 0) * 3.6,\n            wind_mph: (item.wind?.speed || 0) * 2.237,\n            wind_dir: getWindDirection(item.wind?.deg || 0),\n            pressure_mb: item.main.pressure || 0,\n            precip_mm: item.rain?.[\"3h\"] || 0,\n            precip_in: (item.rain?.[\"3h\"] || 0) / 25.4,\n            humidity: item.main.humidity || 0,\n            cloud: item.clouds?.all || 0,\n            feelslike_c: item.main.feels_like || item.main.temp || 0,\n            feelslike_f: (item.main.feels_like || item.main.temp || 0) * 9 / 5 + 32,\n            chance_of_rain: 0,\n            chance_of_snow: 0,\n            vis_km: (item.visibility || 0) / 1000,\n            vis_miles: (item.visibility || 0) / 1609.34,\n            uv: 0\n        });\n    });\n    return Array.from(dailyData.values());\n}\nfunction getWindDirection(degrees) {\n    const directions = [\n        \"N\",\n        \"NNE\",\n        \"NE\",\n        \"ENE\",\n        \"E\",\n        \"ESE\",\n        \"SE\",\n        \"SSE\",\n        \"S\",\n        \"SSW\",\n        \"SW\",\n        \"WSW\",\n        \"W\",\n        \"WNW\",\n        \"NW\",\n        \"NNW\"\n    ];\n    const index = Math.round(degrees / 22.5) % 16;\n    return directions[index];\n}\nasync function GET(request) {\n    try {\n        // Rate limiting check\n        const clientIP = getClientIP(request);\n        if (!checkRateLimit(clientIP)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Rate limit exceeded. Please try again later.\"\n            }, {\n                status: 429\n            });\n        }\n        const { searchParams } = new URL(request.url);\n        const lat = searchParams.get(\"lat\");\n        const lon = searchParams.get(\"lon\");\n        const days = searchParams.get(\"days\");\n        const address = searchParams.get(\"address\");\n        console.log(\"Weather API request:\", {\n            lat,\n            lon,\n            days,\n            address\n        });\n        // Xử lý tìm kiếm theo địa chỉ\n        if (address) {\n            const cacheKey = `weather_address_${address}`;\n            const cached = getCachedData(cacheKey);\n            if (cached) {\n                console.log(\"Returning cached address weather data\");\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(cached);\n            }\n            // Gọi OpenWeatherMap với địa chỉ\n            const apiKey = process.env.WEATHER_API_KEY;\n            if (!apiKey) {\n                console.error(\"Weather API key is not configured\");\n                return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                    error: \"Weather API key is not configured\"\n                }, {\n                    status: 500\n                });\n            }\n            const url = `https://api.openweathermap.org/data/2.5/weather?q=${encodeURIComponent(address)}&appid=${apiKey}&units=metric&lang=vi`;\n            console.log(\"Calling OpenWeatherMap with address:\", url);\n            const response = await fetch(url);\n            if (!response.ok) {\n                const errorText = await response.text();\n                console.error(\"OpenWeatherMap error:\", response.status, errorText);\n                throw new Error(`OpenWeatherMap error: ${response.status} ${response.statusText} - ${errorText}`);\n            }\n            const data = await response.json();\n            console.log(\"OpenWeatherMap response received:\", data);\n            // Validate response data\n            if (!data || typeof data !== \"object\") {\n                throw new Error(\"Invalid response from OpenWeatherMap API\");\n            }\n            const convertedData = convertOpenWeatherMapData(data);\n            setCachedData(cacheKey, convertedData);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(convertedData);\n        }\n        // Xử lý tìm kiếm theo tọa độ\n        if (!lat || !lon) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Missing latitude or longitude parameters\"\n            }, {\n                status: 400\n            });\n        }\n        const latitude = parseFloat(lat);\n        const longitude = parseFloat(lon);\n        const forecastDays = days ? parseInt(days) : 3;\n        if (isNaN(latitude) || isNaN(longitude)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Invalid latitude or longitude values\"\n            }, {\n                status: 400\n            });\n        }\n        // Check cache cho weather data\n        const weatherCacheKey = `weather_${latitude}_${longitude}`;\n        const cachedWeather = getCachedData(weatherCacheKey);\n        if (cachedWeather) {\n            console.log(\"Returning cached weather data\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(cachedWeather);\n        }\n        // Gọi external API\n        const apiKey = process.env.WEATHER_API_KEY || \"b6bd7b2942f4b524dd696aaa422d707b\";\n        if (!apiKey) {\n            console.error(\"Weather API key is not configured\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"Weather API key is not configured\"\n            }, {\n                status: 500\n            });\n        }\n        console.log(\"API Key found, calling OpenWeatherMap APIs...\");\n        // Lấy current weather và forecast từ OpenWeatherMap\n        const currentUrl = `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=vi`;\n        const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=vi&cnt=${forecastDays * 8}`; // 8 data points per day\n        console.log(\"Calling current weather API:\", currentUrl);\n        console.log(\"Calling forecast API:\", forecastUrl);\n        const [currentResponse, forecastResponse] = await Promise.all([\n            fetch(currentUrl),\n            fetch(forecastUrl)\n        ]);\n        console.log(\"API responses received:\", {\n            current: currentResponse.status,\n            forecast: forecastResponse.status\n        });\n        if (!currentResponse.ok) {\n            const errorText = await currentResponse.text();\n            console.error(\"Current weather API error:\", currentResponse.status, errorText);\n            throw new Error(`Current weather API error: ${currentResponse.status} ${currentResponse.statusText} - ${errorText}`);\n        }\n        if (!forecastResponse.ok) {\n            const errorText = await forecastResponse.text();\n            console.error(\"Forecast API error:\", forecastResponse.status, errorText);\n            throw new Error(`Forecast API error: ${forecastResponse.status} ${forecastResponse.statusText} - ${errorText}`);\n        }\n        const [currentData, forecastData] = await Promise.all([\n            currentResponse.json(),\n            forecastResponse.json()\n        ]);\n        console.log(\"Weather data parsed successfully\");\n        console.log(\"Current data sample:\", {\n            name: currentData?.name,\n            main: currentData?.main,\n            weather: currentData?.weather\n        });\n        // Validate response data\n        if (!currentData || typeof currentData !== \"object\") {\n            throw new Error(\"Invalid current weather response from OpenWeatherMap API\");\n        }\n        // Convert OpenWeatherMap data to our format\n        const combinedData = convertOpenWeatherMapData(currentData, forecastData);\n        // Cache the result\n        setCachedData(weatherCacheKey, combinedData);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json(combinedData);\n    } catch (error) {\n        console.error(\"Weather API error:\", error);\n        if (error instanceof Error) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2FpLWZvb2QtcmVjb21tZW5kYXRpb24vLi9zcmMvYXBwL2FwaS93ZWF0aGVyL3JvdXRlLnRzP2FjOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcclxuXHJcbi8vIENhY2hlIGluIG1lbW9yeSAodHJvbmcgcHJvZHVjdGlvbiBuw6puIGTDuW5nIFJlZGlzKVxyXG5jb25zdCB3ZWF0aGVyQ2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyBkYXRhOiBhbnk7IHRpbWVzdGFtcDogbnVtYmVyIH0+KCk7XHJcbmNvbnN0IENBQ0hFX0RVUkFUSU9OID0gMTAgKiA2MCAqIDEwMDA7IC8vIDEwIG1pbnV0ZXNcclxuXHJcbi8vIFJhdGUgbGltaXRpbmcgKHRyb25nIHByb2R1Y3Rpb24gbsOqbiBkw7luZyBSZWRpcylcclxuY29uc3QgcmF0ZUxpbWl0TWFwID0gbmV3IE1hcDxzdHJpbmcsIHsgY291bnQ6IG51bWJlcjsgcmVzZXRUaW1lOiBudW1iZXIgfT4oKTtcclxuY29uc3QgUkFURV9MSU1JVF9XSU5ET1cgPSA2MCAqIDEwMDA7IC8vIDEgbWludXRlXHJcbmNvbnN0IFJBVEVfTElNSVRfTUFYX1JFUVVFU1RTID0gMzA7IC8vIDMwIHJlcXVlc3RzIHBlciBtaW51dGVcclxuXHJcbi8vIEhlbHBlciBmdW5jdGlvbiDEkeG7gyBs4bqleSBjbGllbnQgSVBcclxuZnVuY3Rpb24gZ2V0Q2xpZW50SVAocmVxdWVzdDogTmV4dFJlcXVlc3QpOiBzdHJpbmcge1xyXG4gIHJldHVybiByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKT8uc3BsaXQoJywnKVswXSB8fCBcclxuICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJykgfHwgXHJcbiAgICAgICAgICd1bmtub3duJztcclxufVxyXG5cclxuLy8gUmF0ZSBsaW1pdGluZyBjaGVja1xyXG5mdW5jdGlvbiBjaGVja1JhdGVMaW1pdChjbGllbnRJUDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcclxuICBjb25zdCBjbGllbnREYXRhID0gcmF0ZUxpbWl0TWFwLmdldChjbGllbnRJUCk7XHJcbiAgXHJcbiAgaWYgKCFjbGllbnREYXRhIHx8IG5vdyA+IGNsaWVudERhdGEucmVzZXRUaW1lKSB7XHJcbiAgICByYXRlTGltaXRNYXAuc2V0KGNsaWVudElQLCB7IGNvdW50OiAxLCByZXNldFRpbWU6IG5vdyArIFJBVEVfTElNSVRfV0lORE9XIH0pO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG4gIFxyXG4gIGlmIChjbGllbnREYXRhLmNvdW50ID49IFJBVEVfTElNSVRfTUFYX1JFUVVFU1RTKSB7XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbiAgfVxyXG4gIFxyXG4gIGNsaWVudERhdGEuY291bnQrKztcclxuICByZXR1cm4gdHJ1ZTtcclxufVxyXG5cclxuLy8gQ2FjaGUgaGVscGVyXHJcbmZ1bmN0aW9uIGdldENhY2hlZERhdGEoa2V5OiBzdHJpbmcpOiBhbnkgfCBudWxsIHtcclxuICBjb25zdCBjYWNoZWQgPSB3ZWF0aGVyQ2FjaGUuZ2V0KGtleSk7XHJcbiAgaWYgKCFjYWNoZWQpIHJldHVybiBudWxsO1xyXG4gIFxyXG4gIGlmIChEYXRlLm5vdygpIC0gY2FjaGVkLnRpbWVzdGFtcCA+IENBQ0hFX0RVUkFUSU9OKSB7XHJcbiAgICB3ZWF0aGVyQ2FjaGUuZGVsZXRlKGtleSk7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGNhY2hlZC5kYXRhO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRDYWNoZWREYXRhKGtleTogc3RyaW5nLCBkYXRhOiBhbnkpOiB2b2lkIHtcclxuICB3ZWF0aGVyQ2FjaGUuc2V0KGtleSwge1xyXG4gICAgZGF0YSxcclxuICAgIHRpbWVzdGFtcDogRGF0ZS5ub3coKVxyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBDb252ZXJ0IE9wZW5XZWF0aGVyTWFwIGRhdGEgdG8gb3VyIGZvcm1hdFxyXG5mdW5jdGlvbiBjb252ZXJ0T3BlbldlYXRoZXJNYXBEYXRhKHdlYXRoZXJEYXRhOiBhbnksIGZvcmVjYXN0RGF0YT86IGFueSkge1xyXG4gIGNvbnN0IGN1cnJlbnQgPSB3ZWF0aGVyRGF0YTtcclxuICBcclxuICAvLyBTYWZlIGFjY2VzcyB0byBuZXN0ZWQgcHJvcGVydGllc1xyXG4gIGNvbnN0IGxvY2F0aW9uTmFtZSA9IGN1cnJlbnQ/Lm5hbWUgfHwgJ1Vua25vd24gTG9jYXRpb24nO1xyXG4gIGNvbnN0IGNvdW50cnkgPSBjdXJyZW50Py5zeXM/LmNvdW50cnkgfHwgJyc7XHJcbiAgY29uc3QgbGF0aXR1ZGUgPSBjdXJyZW50Py5jb29yZD8ubGF0IHx8IDA7XHJcbiAgY29uc3QgbG9uZ2l0dWRlID0gY3VycmVudD8uY29vcmQ/LmxvbiB8fCAwO1xyXG4gIGNvbnN0IHRpbWV6b25lID0gY3VycmVudD8udGltZXpvbmUgfHwgMDtcclxuICBcclxuICBjb25zdCB0ZW1wQyA9IGN1cnJlbnQ/Lm1haW4/LnRlbXAgfHwgMDtcclxuICBjb25zdCB0ZW1wRiA9ICh0ZW1wQyAqIDkvNSkgKyAzMjtcclxuICBjb25zdCBmZWVsc0xpa2VDID0gY3VycmVudD8ubWFpbj8uZmVlbHNfbGlrZSB8fCB0ZW1wQztcclxuICBjb25zdCBmZWVsc0xpa2VGID0gKGZlZWxzTGlrZUMgKiA5LzUpICsgMzI7XHJcbiAgY29uc3QgaHVtaWRpdHkgPSBjdXJyZW50Py5tYWluPy5odW1pZGl0eSB8fCAwO1xyXG4gIGNvbnN0IHByZXNzdXJlID0gY3VycmVudD8ubWFpbj8ucHJlc3N1cmUgfHwgMDtcclxuICBcclxuICBjb25zdCB3aW5kU3BlZWQgPSBjdXJyZW50Py53aW5kPy5zcGVlZCB8fCAwO1xyXG4gIGNvbnN0IHdpbmREZWcgPSBjdXJyZW50Py53aW5kPy5kZWcgfHwgMDtcclxuICBjb25zdCB3aW5kS3BoID0gd2luZFNwZWVkICogMy42O1xyXG4gIGNvbnN0IHdpbmRNcGggPSB3aW5kU3BlZWQgKiAyLjIzNztcclxuICBcclxuICBjb25zdCB2aXNpYmlsaXR5ID0gY3VycmVudD8udmlzaWJpbGl0eSB8fCAwO1xyXG4gIGNvbnN0IHZpc2liaWxpdHlLbSA9IHZpc2liaWxpdHkgLyAxMDAwO1xyXG4gIFxyXG4gIGNvbnN0IHdlYXRoZXJDb25kaXRpb24gPSBjdXJyZW50Py53ZWF0aGVyPy5bMF0gfHwge307XHJcbiAgY29uc3QgY29uZGl0aW9uVGV4dCA9IHdlYXRoZXJDb25kaXRpb24uZGVzY3JpcHRpb24gfHwgJ1Vua25vd24nO1xyXG4gIGNvbnN0IGNvbmRpdGlvbkljb24gPSB3ZWF0aGVyQ29uZGl0aW9uLmljb24gPyBgL2FwaS93ZWF0aGVyLWljb24/aWNvbj0ke3dlYXRoZXJDb25kaXRpb24uaWNvbn1gIDogJyc7XHJcbiAgY29uc3QgY29uZGl0aW9uQ29kZSA9IHdlYXRoZXJDb25kaXRpb24uaWQgfHwgMDtcclxuICBcclxuICByZXR1cm4ge1xyXG4gICAgbG9jYXRpb246IHtcclxuICAgICAgbmFtZTogbG9jYXRpb25OYW1lLFxyXG4gICAgICBjb3VudHJ5OiBjb3VudHJ5LFxyXG4gICAgICByZWdpb246ICcnLFxyXG4gICAgICBsYXQ6IGxhdGl0dWRlLFxyXG4gICAgICBsb246IGxvbmdpdHVkZSxcclxuICAgICAgdGltZXpvbmU6IHRpbWV6b25lLFxyXG4gICAgICBsb2NhbHRpbWU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfSxcclxuICAgIGN1cnJlbnQ6IHtcclxuICAgICAgdGVtcF9jOiB0ZW1wQyxcclxuICAgICAgdGVtcF9mOiB0ZW1wRixcclxuICAgICAgY29uZGl0aW9uOiB7XHJcbiAgICAgICAgdGV4dDogY29uZGl0aW9uVGV4dCxcclxuICAgICAgICBpY29uOiBjb25kaXRpb25JY29uLFxyXG4gICAgICAgIGNvZGU6IGNvbmRpdGlvbkNvZGVcclxuICAgICAgfSxcclxuICAgICAgaHVtaWRpdHk6IGh1bWlkaXR5LFxyXG4gICAgICB3aW5kX2twaDogd2luZEtwaCxcclxuICAgICAgd2luZF9tcGg6IHdpbmRNcGgsXHJcbiAgICAgIHdpbmRfZGlyOiBnZXRXaW5kRGlyZWN0aW9uKHdpbmREZWcpLFxyXG4gICAgICBwcmVzc3VyZV9tYjogcHJlc3N1cmUsXHJcbiAgICAgIGZlZWxzbGlrZV9jOiBmZWVsc0xpa2VDLFxyXG4gICAgICBmZWVsc2xpa2VfZjogZmVlbHNMaWtlRixcclxuICAgICAgdXY6IDAsIC8vIE9wZW5XZWF0aGVyTWFwIGRvZXNuJ3QgcHJvdmlkZSBVViBpbiBmcmVlIHRpZXJcclxuICAgICAgdmlzaWJpbGl0eV9rbTogdmlzaWJpbGl0eUttLFxyXG4gICAgICBsYXN0X3VwZGF0ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgdmlzX2ttOiB2aXNpYmlsaXR5S21cclxuICAgIH0sXHJcbiAgICBmb3JlY2FzdDoge1xyXG4gICAgICBmb3JlY2FzdGRheTogZm9yZWNhc3REYXRhID8gY29udmVydEZvcmVjYXN0RGF0YShmb3JlY2FzdERhdGEpIDogW11cclxuICAgIH1cclxuICB9O1xyXG59XHJcblxyXG5mdW5jdGlvbiBjb252ZXJ0Rm9yZWNhc3REYXRhKGZvcmVjYXN0RGF0YTogYW55KSB7XHJcbiAgaWYgKCFmb3JlY2FzdERhdGE/Lmxpc3QgfHwgIUFycmF5LmlzQXJyYXkoZm9yZWNhc3REYXRhLmxpc3QpKSB7XHJcbiAgICBjb25zb2xlLndhcm4oJ0ludmFsaWQgZm9yZWNhc3QgZGF0YSBzdHJ1Y3R1cmU6JywgZm9yZWNhc3REYXRhKTtcclxuICAgIHJldHVybiBbXTtcclxuICB9XHJcbiAgXHJcbiAgLy8gR3JvdXAgYnkgZGF5XHJcbiAgY29uc3QgZGFpbHlEYXRhID0gbmV3IE1hcCgpO1xyXG4gIFxyXG4gIGZvcmVjYXN0RGF0YS5saXN0LmZvckVhY2goKGl0ZW06IGFueSkgPT4ge1xyXG4gICAgaWYgKCFpdGVtPy5kdCB8fCAhaXRlbT8ubWFpbiB8fCAhaXRlbT8ud2VhdGhlcj8uWzBdKSB7XHJcbiAgICAgIGNvbnNvbGUud2FybignSW52YWxpZCBmb3JlY2FzdCBpdGVtOicsIGl0ZW0pO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShpdGVtLmR0ICogMTAwMCkudG9EYXRlU3RyaW5nKCk7XHJcbiAgICBpZiAoIWRhaWx5RGF0YS5oYXMoZGF0ZSkpIHtcclxuICAgICAgZGFpbHlEYXRhLnNldChkYXRlLCB7XHJcbiAgICAgICAgZGF0ZTogbmV3IERhdGUoaXRlbS5kdCAqIDEwMDApLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSxcclxuICAgICAgICBkYXk6IHtcclxuICAgICAgICAgIG1heHRlbXBfYzogaXRlbS5tYWluLnRlbXBfbWF4IHx8IDAsXHJcbiAgICAgICAgICBtYXh0ZW1wX2Y6ICgoaXRlbS5tYWluLnRlbXBfbWF4IHx8IDApICogOS81KSArIDMyLFxyXG4gICAgICAgICAgbWludGVtcF9jOiBpdGVtLm1haW4udGVtcF9taW4gfHwgMCxcclxuICAgICAgICAgIG1pbnRlbXBfZjogKChpdGVtLm1haW4udGVtcF9taW4gfHwgMCkgKiA5LzUpICsgMzIsXHJcbiAgICAgICAgICBhdmd0ZW1wX2M6IGl0ZW0ubWFpbi50ZW1wIHx8IDAsXHJcbiAgICAgICAgICBhdmd0ZW1wX2Y6ICgoaXRlbS5tYWluLnRlbXAgfHwgMCkgKiA5LzUpICsgMzIsXHJcbiAgICAgICAgICBtYXh3aW5kX2twaDogKGl0ZW0ud2luZD8uc3BlZWQgfHwgMCkgKiAzLjYsXHJcbiAgICAgICAgICBtYXh3aW5kX21waDogKGl0ZW0ud2luZD8uc3BlZWQgfHwgMCkgKiAyLjIzNyxcclxuICAgICAgICAgIHRvdGFscHJlY2lwX21tOiBpdGVtLnJhaW4/LlsnM2gnXSB8fCAwLFxyXG4gICAgICAgICAgdG90YWxwcmVjaXBfaW46ICgoaXRlbS5yYWluPy5bJzNoJ10gfHwgMCkgLyAyNS40KSxcclxuICAgICAgICAgIGF2Z2h1bWlkaXR5OiBpdGVtLm1haW4uaHVtaWRpdHkgfHwgMCxcclxuICAgICAgICAgIGNvbmRpdGlvbjoge1xyXG4gICAgICAgICAgICB0ZXh0OiBpdGVtLndlYXRoZXJbMF0uZGVzY3JpcHRpb24gfHwgJ1Vua25vd24nLFxyXG4gICAgICAgICAgICBpY29uOiBpdGVtLndlYXRoZXJbMF0uaWNvbiA/IGAvYXBpL3dlYXRoZXItaWNvbj9pY29uPSR7aXRlbS53ZWF0aGVyWzBdLmljb259YCA6ICcnLFxyXG4gICAgICAgICAgICBjb2RlOiBpdGVtLndlYXRoZXJbMF0uaWQgfHwgMFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICAgIHV2OiAwXHJcbiAgICAgICAgfSxcclxuICAgICAgICBob3VyOiBbXVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZGFpbHlEYXRhLmdldChkYXRlKS5ob3VyLnB1c2goe1xyXG4gICAgICB0aW1lOiBuZXcgRGF0ZShpdGVtLmR0ICogMTAwMCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgdGVtcF9jOiBpdGVtLm1haW4udGVtcCB8fCAwLFxyXG4gICAgICB0ZW1wX2Y6ICgoaXRlbS5tYWluLnRlbXAgfHwgMCkgKiA5LzUpICsgMzIsXHJcbiAgICAgIGNvbmRpdGlvbjoge1xyXG4gICAgICAgIHRleHQ6IGl0ZW0ud2VhdGhlclswXS5kZXNjcmlwdGlvbiB8fCAnVW5rbm93bicsXHJcbiAgICAgICAgaWNvbjogaXRlbS53ZWF0aGVyWzBdLmljb24gPyBgL2FwaS93ZWF0aGVyLWljb24/aWNvbj0ke2l0ZW0ud2VhdGhlclswXS5pY29ufWAgOiAnJyxcclxuICAgICAgICBjb2RlOiBpdGVtLndlYXRoZXJbMF0uaWQgfHwgMFxyXG4gICAgICB9LFxyXG4gICAgICB3aW5kX2twaDogKGl0ZW0ud2luZD8uc3BlZWQgfHwgMCkgKiAzLjYsXHJcbiAgICAgIHdpbmRfbXBoOiAoaXRlbS53aW5kPy5zcGVlZCB8fCAwKSAqIDIuMjM3LFxyXG4gICAgICB3aW5kX2RpcjogZ2V0V2luZERpcmVjdGlvbihpdGVtLndpbmQ/LmRlZyB8fCAwKSxcclxuICAgICAgcHJlc3N1cmVfbWI6IGl0ZW0ubWFpbi5wcmVzc3VyZSB8fCAwLFxyXG4gICAgICBwcmVjaXBfbW06IGl0ZW0ucmFpbj8uWyczaCddIHx8IDAsXHJcbiAgICAgIHByZWNpcF9pbjogKChpdGVtLnJhaW4/LlsnM2gnXSB8fCAwKSAvIDI1LjQpLFxyXG4gICAgICBodW1pZGl0eTogaXRlbS5tYWluLmh1bWlkaXR5IHx8IDAsXHJcbiAgICAgIGNsb3VkOiBpdGVtLmNsb3Vkcz8uYWxsIHx8IDAsXHJcbiAgICAgIGZlZWxzbGlrZV9jOiBpdGVtLm1haW4uZmVlbHNfbGlrZSB8fCBpdGVtLm1haW4udGVtcCB8fCAwLFxyXG4gICAgICBmZWVsc2xpa2VfZjogKChpdGVtLm1haW4uZmVlbHNfbGlrZSB8fCBpdGVtLm1haW4udGVtcCB8fCAwKSAqIDkvNSkgKyAzMixcclxuICAgICAgY2hhbmNlX29mX3JhaW46IDAsXHJcbiAgICAgIGNoYW5jZV9vZl9zbm93OiAwLFxyXG4gICAgICB2aXNfa206IChpdGVtLnZpc2liaWxpdHkgfHwgMCkgLyAxMDAwLFxyXG4gICAgICB2aXNfbWlsZXM6IChpdGVtLnZpc2liaWxpdHkgfHwgMCkgLyAxNjA5LjM0LFxyXG4gICAgICB1djogMFxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbiAgXHJcbiAgcmV0dXJuIEFycmF5LmZyb20oZGFpbHlEYXRhLnZhbHVlcygpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0V2luZERpcmVjdGlvbihkZWdyZWVzOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gIGNvbnN0IGRpcmVjdGlvbnMgPSBbJ04nLCAnTk5FJywgJ05FJywgJ0VORScsICdFJywgJ0VTRScsICdTRScsICdTU0UnLCAnUycsICdTU1cnLCAnU1cnLCAnV1NXJywgJ1cnLCAnV05XJywgJ05XJywgJ05OVyddO1xyXG4gIGNvbnN0IGluZGV4ID0gTWF0aC5yb3VuZChkZWdyZWVzIC8gMjIuNSkgJSAxNjtcclxuICByZXR1cm4gZGlyZWN0aW9uc1tpbmRleF07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgLy8gUmF0ZSBsaW1pdGluZyBjaGVja1xyXG4gICAgY29uc3QgY2xpZW50SVAgPSBnZXRDbGllbnRJUChyZXF1ZXN0KTtcclxuICAgIGlmICghY2hlY2tSYXRlTGltaXQoY2xpZW50SVApKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnUmF0ZSBsaW1pdCBleGNlZWRlZC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQyOSB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xyXG4gICAgY29uc3QgbGF0ID0gc2VhcmNoUGFyYW1zLmdldCgnbGF0Jyk7XHJcbiAgICBjb25zdCBsb24gPSBzZWFyY2hQYXJhbXMuZ2V0KCdsb24nKTtcclxuICAgIGNvbnN0IGRheXMgPSBzZWFyY2hQYXJhbXMuZ2V0KCdkYXlzJyk7XHJcbiAgICBjb25zdCBhZGRyZXNzID0gc2VhcmNoUGFyYW1zLmdldCgnYWRkcmVzcycpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdXZWF0aGVyIEFQSSByZXF1ZXN0OicsIHsgbGF0LCBsb24sIGRheXMsIGFkZHJlc3MgfSk7XHJcblxyXG4gICAgLy8gWOG7rSBsw70gdMOsbSBraeG6v20gdGhlbyDEkeG7i2EgY2jhu4lcclxuICAgIGlmIChhZGRyZXNzKSB7XHJcbiAgICAgIGNvbnN0IGNhY2hlS2V5ID0gYHdlYXRoZXJfYWRkcmVzc18ke2FkZHJlc3N9YDtcclxuICAgICAgY29uc3QgY2FjaGVkID0gZ2V0Q2FjaGVkRGF0YShjYWNoZUtleSk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoY2FjaGVkKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ1JldHVybmluZyBjYWNoZWQgYWRkcmVzcyB3ZWF0aGVyIGRhdGEnKTtcclxuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2FjaGVkKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gR+G7jWkgT3BlbldlYXRoZXJNYXAgduG7m2kgxJHhu4thIGNo4buJXHJcbiAgICAgIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52LldFQVRIRVJfQVBJX0tFWSA7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIWFwaUtleSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYXRoZXIgQVBJIGtleSBpcyBub3QgY29uZmlndXJlZCcpO1xyXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICAgIHsgZXJyb3I6ICdXZWF0aGVyIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQnIH0sXHJcbiAgICAgICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCB1cmwgPSBgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L3dlYXRoZXI/cT0ke2VuY29kZVVSSUNvbXBvbmVudChhZGRyZXNzKX0mYXBwaWQ9JHthcGlLZXl9JnVuaXRzPW1ldHJpYyZsYW5nPXZpYDtcclxuICAgICAgY29uc29sZS5sb2coJ0NhbGxpbmcgT3BlbldlYXRoZXJNYXAgd2l0aCBhZGRyZXNzOicsIHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCk7XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3JUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ09wZW5XZWF0aGVyTWFwIGVycm9yOicsIHJlc3BvbnNlLnN0YXR1cywgZXJyb3JUZXh0KTtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE9wZW5XZWF0aGVyTWFwIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fSAtICR7ZXJyb3JUZXh0fWApO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICBjb25zb2xlLmxvZygnT3BlbldlYXRoZXJNYXAgcmVzcG9uc2UgcmVjZWl2ZWQ6JywgZGF0YSk7XHJcbiAgICAgIFxyXG4gICAgICAvLyBWYWxpZGF0ZSByZXNwb25zZSBkYXRhXHJcbiAgICAgIGlmICghZGF0YSB8fCB0eXBlb2YgZGF0YSAhPT0gJ29iamVjdCcpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZnJvbSBPcGVuV2VhdGhlck1hcCBBUEknKTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgY29uc3QgY29udmVydGVkRGF0YSA9IGNvbnZlcnRPcGVuV2VhdGhlck1hcERhdGEoZGF0YSk7XHJcbiAgICAgIHNldENhY2hlZERhdGEoY2FjaGVLZXksIGNvbnZlcnRlZERhdGEpO1xyXG4gICAgICBcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGNvbnZlcnRlZERhdGEpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFjhu60gbMO9IHTDrG0ga2nhur9tIHRoZW8gdOG7jWEgxJHhu5lcclxuICAgIGlmICghbGF0IHx8ICFsb24pIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdNaXNzaW5nIGxhdGl0dWRlIG9yIGxvbmdpdHVkZSBwYXJhbWV0ZXJzJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGxhdGl0dWRlID0gcGFyc2VGbG9hdChsYXQpO1xyXG4gICAgY29uc3QgbG9uZ2l0dWRlID0gcGFyc2VGbG9hdChsb24pO1xyXG4gICAgY29uc3QgZm9yZWNhc3REYXlzID0gZGF5cyA/IHBhcnNlSW50KGRheXMpIDogMztcclxuXHJcbiAgICBpZiAoaXNOYU4obGF0aXR1ZGUpIHx8IGlzTmFOKGxvbmdpdHVkZSkpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdJbnZhbGlkIGxhdGl0dWRlIG9yIGxvbmdpdHVkZSB2YWx1ZXMnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ2hlY2sgY2FjaGUgY2hvIHdlYXRoZXIgZGF0YVxyXG4gICAgY29uc3Qgd2VhdGhlckNhY2hlS2V5ID0gYHdlYXRoZXJfJHtsYXRpdHVkZX1fJHtsb25naXR1ZGV9YDtcclxuICAgIGNvbnN0IGNhY2hlZFdlYXRoZXIgPSBnZXRDYWNoZWREYXRhKHdlYXRoZXJDYWNoZUtleSk7XHJcbiAgICBcclxuICAgIGlmIChjYWNoZWRXZWF0aGVyKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdSZXR1cm5pbmcgY2FjaGVkIHdlYXRoZXIgZGF0YScpO1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY2FjaGVkV2VhdGhlcik7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR+G7jWkgZXh0ZXJuYWwgQVBJXHJcbiAgICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5XRUFUSEVSX0FQSV9LRVkgfHwgXCJiNmJkN2IyOTQyZjRiNTI0ZGQ2OTZhYWE0MjJkNzA3YlwiO1xyXG4gICAgXHJcbiAgICBpZiAoIWFwaUtleSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdXZWF0aGVyIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQnKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6ICdXZWF0aGVyIEFQSSBrZXkgaXMgbm90IGNvbmZpZ3VyZWQnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICAgICk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0FQSSBLZXkgZm91bmQsIGNhbGxpbmcgT3BlbldlYXRoZXJNYXAgQVBJcy4uLicpO1xyXG5cclxuICAgIC8vIEzhuqV5IGN1cnJlbnQgd2VhdGhlciB2w6AgZm9yZWNhc3QgdOG7qyBPcGVuV2VhdGhlck1hcFxyXG4gICAgY29uc3QgY3VycmVudFVybCA9IGBodHRwczovL2FwaS5vcGVud2VhdGhlcm1hcC5vcmcvZGF0YS8yLjUvd2VhdGhlcj9sYXQ9JHtsYXRpdHVkZX0mbG9uPSR7bG9uZ2l0dWRlfSZhcHBpZD0ke2FwaUtleX0mdW5pdHM9bWV0cmljJmxhbmc9dmlgO1xyXG4gICAgY29uc3QgZm9yZWNhc3RVcmwgPSBgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L2ZvcmVjYXN0P2xhdD0ke2xhdGl0dWRlfSZsb249JHtsb25naXR1ZGV9JmFwcGlkPSR7YXBpS2V5fSZ1bml0cz1tZXRyaWMmbGFuZz12aSZjbnQ9JHtmb3JlY2FzdERheXMgKiA4fWA7IC8vIDggZGF0YSBwb2ludHMgcGVyIGRheVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnQ2FsbGluZyBjdXJyZW50IHdlYXRoZXIgQVBJOicsIGN1cnJlbnRVcmwpO1xyXG4gICAgY29uc29sZS5sb2coJ0NhbGxpbmcgZm9yZWNhc3QgQVBJOicsIGZvcmVjYXN0VXJsKTtcclxuXHJcbiAgICBjb25zdCBbY3VycmVudFJlc3BvbnNlLCBmb3JlY2FzdFJlc3BvbnNlXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgZmV0Y2goY3VycmVudFVybCksXHJcbiAgICAgIGZldGNoKGZvcmVjYXN0VXJsKVxyXG4gICAgXSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coJ0FQSSByZXNwb25zZXMgcmVjZWl2ZWQ6Jywge1xyXG4gICAgICBjdXJyZW50OiBjdXJyZW50UmVzcG9uc2Uuc3RhdHVzLFxyXG4gICAgICBmb3JlY2FzdDogZm9yZWNhc3RSZXNwb25zZS5zdGF0dXNcclxuICAgIH0pO1xyXG5cclxuICAgIGlmICghY3VycmVudFJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IGN1cnJlbnRSZXNwb25zZS50ZXh0KCk7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0N1cnJlbnQgd2VhdGhlciBBUEkgZXJyb3I6JywgY3VycmVudFJlc3BvbnNlLnN0YXR1cywgZXJyb3JUZXh0KTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDdXJyZW50IHdlYXRoZXIgQVBJIGVycm9yOiAke2N1cnJlbnRSZXNwb25zZS5zdGF0dXN9ICR7Y3VycmVudFJlc3BvbnNlLnN0YXR1c1RleHR9IC0gJHtlcnJvclRleHR9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFmb3JlY2FzdFJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IGZvcmVjYXN0UmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGb3JlY2FzdCBBUEkgZXJyb3I6JywgZm9yZWNhc3RSZXNwb25zZS5zdGF0dXMsIGVycm9yVGV4dCk7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRm9yZWNhc3QgQVBJIGVycm9yOiAke2ZvcmVjYXN0UmVzcG9uc2Uuc3RhdHVzfSAke2ZvcmVjYXN0UmVzcG9uc2Uuc3RhdHVzVGV4dH0gLSAke2Vycm9yVGV4dH1gKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBbY3VycmVudERhdGEsIGZvcmVjYXN0RGF0YV0gPSBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgIGN1cnJlbnRSZXNwb25zZS5qc29uKCksXHJcbiAgICAgIGZvcmVjYXN0UmVzcG9uc2UuanNvbigpXHJcbiAgICBdKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZygnV2VhdGhlciBkYXRhIHBhcnNlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgIGNvbnNvbGUubG9nKCdDdXJyZW50IGRhdGEgc2FtcGxlOicsIHtcclxuICAgICAgbmFtZTogY3VycmVudERhdGE/Lm5hbWUsXHJcbiAgICAgIG1haW46IGN1cnJlbnREYXRhPy5tYWluLFxyXG4gICAgICB3ZWF0aGVyOiBjdXJyZW50RGF0YT8ud2VhdGhlclxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gVmFsaWRhdGUgcmVzcG9uc2UgZGF0YVxyXG4gICAgaWYgKCFjdXJyZW50RGF0YSB8fCB0eXBlb2YgY3VycmVudERhdGEgIT09ICdvYmplY3QnKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBjdXJyZW50IHdlYXRoZXIgcmVzcG9uc2UgZnJvbSBPcGVuV2VhdGhlck1hcCBBUEknKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBDb252ZXJ0IE9wZW5XZWF0aGVyTWFwIGRhdGEgdG8gb3VyIGZvcm1hdFxyXG4gICAgY29uc3QgY29tYmluZWREYXRhID0gY29udmVydE9wZW5XZWF0aGVyTWFwRGF0YShjdXJyZW50RGF0YSwgZm9yZWNhc3REYXRhKTtcclxuXHJcbiAgICAvLyBDYWNoZSB0aGUgcmVzdWx0XHJcbiAgICBzZXRDYWNoZWREYXRhKHdlYXRoZXJDYWNoZUtleSwgY29tYmluZWREYXRhKTtcclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oY29tYmluZWREYXRhKTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1dlYXRoZXIgQVBJIGVycm9yOicsIGVycm9yKTtcclxuICAgIFxyXG4gICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxyXG4gICAgICAgIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSxcclxuICAgICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKTtcclxuICB9XHJcbn0gIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIndlYXRoZXJDYWNoZSIsIk1hcCIsIkNBQ0hFX0RVUkFUSU9OIiwicmF0ZUxpbWl0TWFwIiwiUkFURV9MSU1JVF9XSU5ET1ciLCJSQVRFX0xJTUlUX01BWF9SRVFVRVNUUyIsImdldENsaWVudElQIiwicmVxdWVzdCIsImhlYWRlcnMiLCJnZXQiLCJzcGxpdCIsImNoZWNrUmF0ZUxpbWl0IiwiY2xpZW50SVAiLCJub3ciLCJEYXRlIiwiY2xpZW50RGF0YSIsInJlc2V0VGltZSIsInNldCIsImNvdW50IiwiZ2V0Q2FjaGVkRGF0YSIsImtleSIsImNhY2hlZCIsInRpbWVzdGFtcCIsImRlbGV0ZSIsImRhdGEiLCJzZXRDYWNoZWREYXRhIiwiY29udmVydE9wZW5XZWF0aGVyTWFwRGF0YSIsIndlYXRoZXJEYXRhIiwiZm9yZWNhc3REYXRhIiwiY3VycmVudCIsImxvY2F0aW9uTmFtZSIsIm5hbWUiLCJjb3VudHJ5Iiwic3lzIiwibGF0aXR1ZGUiLCJjb29yZCIsImxhdCIsImxvbmdpdHVkZSIsImxvbiIsInRpbWV6b25lIiwidGVtcEMiLCJtYWluIiwidGVtcCIsInRlbXBGIiwiZmVlbHNMaWtlQyIsImZlZWxzX2xpa2UiLCJmZWVsc0xpa2VGIiwiaHVtaWRpdHkiLCJwcmVzc3VyZSIsIndpbmRTcGVlZCIsIndpbmQiLCJzcGVlZCIsIndpbmREZWciLCJkZWciLCJ3aW5kS3BoIiwid2luZE1waCIsInZpc2liaWxpdHkiLCJ2aXNpYmlsaXR5S20iLCJ3ZWF0aGVyQ29uZGl0aW9uIiwid2VhdGhlciIsImNvbmRpdGlvblRleHQiLCJkZXNjcmlwdGlvbiIsImNvbmRpdGlvbkljb24iLCJpY29uIiwiY29uZGl0aW9uQ29kZSIsImlkIiwibG9jYXRpb24iLCJyZWdpb24iLCJsb2NhbHRpbWUiLCJ0b0lTT1N0cmluZyIsInRlbXBfYyIsInRlbXBfZiIsImNvbmRpdGlvbiIsInRleHQiLCJjb2RlIiwid2luZF9rcGgiLCJ3aW5kX21waCIsIndpbmRfZGlyIiwiZ2V0V2luZERpcmVjdGlvbiIsInByZXNzdXJlX21iIiwiZmVlbHNsaWtlX2MiLCJmZWVsc2xpa2VfZiIsInV2IiwidmlzaWJpbGl0eV9rbSIsImxhc3RfdXBkYXRlZCIsInZpc19rbSIsImZvcmVjYXN0IiwiZm9yZWNhc3RkYXkiLCJjb252ZXJ0Rm9yZWNhc3REYXRhIiwibGlzdCIsIkFycmF5IiwiaXNBcnJheSIsImNvbnNvbGUiLCJ3YXJuIiwiZGFpbHlEYXRhIiwiZm9yRWFjaCIsIml0ZW0iLCJkdCIsImRhdGUiLCJ0b0RhdGVTdHJpbmciLCJoYXMiLCJkYXkiLCJtYXh0ZW1wX2MiLCJ0ZW1wX21heCIsIm1heHRlbXBfZiIsIm1pbnRlbXBfYyIsInRlbXBfbWluIiwibWludGVtcF9mIiwiYXZndGVtcF9jIiwiYXZndGVtcF9mIiwibWF4d2luZF9rcGgiLCJtYXh3aW5kX21waCIsInRvdGFscHJlY2lwX21tIiwicmFpbiIsInRvdGFscHJlY2lwX2luIiwiYXZnaHVtaWRpdHkiLCJob3VyIiwicHVzaCIsInRpbWUiLCJwcmVjaXBfbW0iLCJwcmVjaXBfaW4iLCJjbG91ZCIsImNsb3VkcyIsImFsbCIsImNoYW5jZV9vZl9yYWluIiwiY2hhbmNlX29mX3Nub3ciLCJ2aXNfbWlsZXMiLCJmcm9tIiwidmFsdWVzIiwiZGVncmVlcyIsImRpcmVjdGlvbnMiLCJpbmRleCIsIk1hdGgiLCJyb3VuZCIsIkdFVCIsImpzb24iLCJlcnJvciIsInN0YXR1cyIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImRheXMiLCJhZGRyZXNzIiwibG9nIiwiY2FjaGVLZXkiLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiV0VBVEhFUl9BUElfS0VZIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVzcG9uc2UiLCJmZXRjaCIsIm9rIiwiZXJyb3JUZXh0IiwiRXJyb3IiLCJzdGF0dXNUZXh0IiwiY29udmVydGVkRGF0YSIsInBhcnNlRmxvYXQiLCJmb3JlY2FzdERheXMiLCJwYXJzZUludCIsImlzTmFOIiwid2VhdGhlckNhY2hlS2V5IiwiY2FjaGVkV2VhdGhlciIsImN1cnJlbnRVcmwiLCJmb3JlY2FzdFVybCIsImN1cnJlbnRSZXNwb25zZSIsImZvcmVjYXN0UmVzcG9uc2UiLCJQcm9taXNlIiwiY3VycmVudERhdGEiLCJjb21iaW5lZERhdGEiLCJtZXNzYWdlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/weather/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fweather%2Froute&page=%2Fapi%2Fweather%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fweather%2Froute.ts&appDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=D%3A%5CKh%C3%B3a%20lu%E1%BA%ADn%20t%E1%BB%91t%20nghi%E1%BB%87p%5Cfe-kltn&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();